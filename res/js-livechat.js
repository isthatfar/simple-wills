var ch_send_timer,ch_ini=0,ch_history_req=0,ch_id=0,ch_s="",ch_lastupd=0,ch_open=0,ch_notif=0,ch_temp_mess=[],ch_prepsend=0,ch_basemess='<div class="chat_m clear"><div class="av"></div><div class="message">Hello, do you have any questions? I\'m here if you need anything.</div></div>';function getCookie(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function lch_toggle(){document.querySelector(".chat_w").classList.toggle("hidden"),document.querySelector(".chat_b").classList.toggle("hidden"),0==ch_open?(ch_open=1,document.querySelector(".chat_w .chat_write textarea").focus(),document.cookie="lch_open=1;path=/",0==ch_history_req&&lch_history(0),lch_scroll()):(ch_open=0,document.cookie="lch_open=0;path=/")}function ch_faq(e){"item"==e.parentNode.className?e.parentNode.className="item active":e.parentNode.className="item"}function lch_history(e){ch_history_req=1;var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState){var c=JSON.parse(t.responseText);if(void 0!==c.id&&c.id!=ch_id){ch_id=c.id,ch_s=c.s;var o=new Date;o.setTime(o.getTime()+36e6),document.cookie="lch_id="+c.id+";expires="+o.toUTCString()+";path=/",document.cookie="lch_s="+c.s+";expires="+o.toUTCString()+";path=/",document.cookie="lch_lastupd="+c.date+";expires="+o.toUTCString()+";path=/",document.querySelector(".chat_w .chat_box").innerHTML=ch_basemess}else document.querySelector(".chat_w .chat_box").innerHTML=ch_basemess,document.querySelector(".chat_w .chat_box").innerHTML+=c.mess,1==e&&(ch_open=1,document.querySelector(".chat_w").classList.toggle("hidden"),document.querySelector(".chat_b").classList.toggle("hidden")),lch_scroll()}},t.open("POST","livechat.html"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("id="+ch_id+"&s="+ch_s+"&mess=&url=&hist=1")}function lch_send(){ch_prepsend=0,clearTimeout(ch_send_timer);var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){var t=JSON.parse(e.responseText);if(void 0!==t.id&&t.id!=ch_id){ch_id=t.id,ch_s=t.s;var c=new Date;c.setTime(c.getTime()+36e6),document.cookie="lch_id="+t.id+";expires="+c.toUTCString()+";path=/",document.cookie="lch_s="+t.s+";expires="+c.toUTCString()+";path=/",document.cookie="lch_lastupd="+t.date+";expires="+c.toUTCString()+";path=/"}var o=1e3*(2*Math.random()+3);document.querySelector(".chat_w .chat_box").innerHTML+='<div class="chat_m clear loader"><div class="av"></div><div class="anim"><u></u><u></u><u></u></div></div>',lch_scroll(),setTimeout(function(){document.querySelector(".chat_w .chat_box .loader").remove(),document.querySelector(".chat_w .chat_box").innerHTML+='<div class="chat_m clear"><div class="av"></div><div class="message">'+t.mess+"</div></div>",lch_scroll()},o)}},e.open("POST","livechat.html"),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send("id="+ch_id+"&s="+ch_s+"&mess="+encodeURIComponent(JSON.stringify(ch_temp_mess))+"&url="+encodeURIComponent(window.location.href)),ch_temp_mess=[]}function lch_add(){var e=document.querySelector(".chat_w .chat_write textarea").value;""!=e&&(ch_temp_mess.push(e),ch_prepsend=1,clearTimeout(ch_send_timer),ch_send_timer=setTimeout(lch_send,3e3),document.querySelector(".chat_w .chat_write textarea").value="",document.querySelector(".chat_w .chat_box").innerHTML+='<div class="chat_m clear"><div class="message client">'+e.replace(/[<>]/g,"")+"</div></div>",lch_scroll(),document.querySelector(".chat_w .chat_write textarea").style.height="72px")}function lch_scroll(){var e=document.querySelector(".chat_w .chat_box");e.scrollTop=e.scrollHeight}window.addEventListener("load",function(){if(0==ch_ini){document.querySelector(".chat_w").innerHTML='<div class="chat_w_container"><div class="chat_top"><div class="chat_title">ProperWills Online Assistant</div><div class="chat_close" tabindex="0" aria-label="Close chat" role="button"></div></div><div class="chat_box"></div><div class="chat_write"><textarea placeholder="Type your message..."></textarea><div class="chat_send" tabindex="0" aria-label="Send message" role="button"></div></div></div>';const e=document.querySelector(".chat_w .chat_write textarea");e.setAttribute("style","height:"+e.scrollHeight+"px;"),e.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px",1==ch_prepsend&&(clearTimeout(ch_send_timer),ch_send_timer=setTimeout(lch_send,8e3))},!1),document.querySelector(".chat_b").addEventListener("keypress",function(e){"Enter"===e.key&&(lch_toggle(),e.preventDefault())}),document.querySelector(".chat_b").addEventListener("click",lch_toggle),document.querySelector(".chat_close").addEventListener("keypress",function(e){"Enter"===e.key&&(lch_toggle(),e.preventDefault())}),document.querySelector(".chat_close").addEventListener("click",lch_toggle),document.querySelector(".chat_send").addEventListener("click",lch_add,!1),document.querySelector(".chat_send").addEventListener("keypress",function(e){"Enter"===e.key&&(lch_add(),e.preventDefault())}),document.querySelector(".chat_write textarea").addEventListener("keypress",function(e){"Enter"===e.key&&(lch_add(),e.preventDefault())}),ch_ini=1}""!=getCookie("lch_id")&&""!=getCookie("lch_s")?(ch_id=getCookie("lch_id"),ch_s=getCookie("lch_s"),1==getCookie("lch_open")&&0==ch_history_req&&lch_history(1)):document.querySelector(".chat_w .chat_box").innerHTML=ch_basemess});